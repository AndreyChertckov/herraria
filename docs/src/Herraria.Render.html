<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Module responsible for drawing the game</span><span>
</span><a name="line-2"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Herraria.Render</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Graphics.Gloss</span><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span>           </span><a href="Herraria.Config.html"><span class="hs-identifier">Herraria.Config</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">unit</span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span>           </span><a href="Herraria.Level.html"><span class="hs-identifier">Herraria.Level</span></a><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span>           </span><a href="Herraria.Player.html"><span class="hs-identifier">Herraria.Player</span></a><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span>           </span><a href="Herraria.World.html"><span class="hs-identifier">Herraria.World</span></a><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-comment">-- | Color of the air</span><span>
</span><a name="line-11"></a><span class="hs-identifier">airBlue</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Color</span><span>
</span><a name="line-12"></a><a name="airBlue"><a href="Herraria.Render.html#airBlue"><span class="hs-identifier">airBlue</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">makeColorI</span><span> </span><span class="hs-number">219</span><span> </span><span class="hs-number">236</span><span> </span><span class="hs-number">245</span><span> </span><span class="hs-number">128</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-comment">-- Make use of Gloss.Viewport functions</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- | Center the view on the player</span><span>
</span><a name="line-16"></a><span class="hs-identifier">focusOnPlayer</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Herraria.Player.html#Player"><span class="hs-identifier hs-type">Player</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Picture</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Picture</span><span>
</span><a name="line-17"></a><a name="focusOnPlayer"><a href="Herraria.Render.html#focusOnPlayer"><span class="hs-identifier">focusOnPlayer</span></a></a><span> </span><span class="hs-special">(</span><a href="Herraria.Player.html#Player"><span class="hs-identifier hs-var">Player</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679085548"><a href="#local-6989586621679085548"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679085549"><a href="#local-6989586621679085549"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">translate</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679085548"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679085549"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-comment">-- | Scale view</span><span>
</span><a name="line-20"></a><span class="hs-identifier">scaleViewPort</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Picture</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Picture</span><span>
</span><a name="line-21"></a><a name="scaleViewPort"><a href="Herraria.Render.html#scaleViewPort"><span class="hs-identifier">scaleViewPort</span></a></a><span> </span><a name="local-6989586621679085550"><a href="#local-6989586621679085550"><span class="hs-identifier">coef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">scale</span><span> </span><a href="#local-6989586621679085550"><span class="hs-identifier hs-var">coef</span></a><span> </span><a href="#local-6989586621679085550"><span class="hs-identifier hs-var">coef</span></a><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-comment">-- | Main function of drawing</span><span>
</span><a name="line-24"></a><span class="hs-identifier">drawWorld</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Herraria.World.html#GameState"><span class="hs-identifier hs-type">GameState</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Picture</span><span>
</span><a name="line-25"></a><a name="drawWorld"><a href="Herraria.Render.html#drawWorld"><span class="hs-identifier">drawWorld</span></a></a><span> </span><span class="hs-special">(</span><a href="Herraria.World.html#GameState"><span class="hs-identifier hs-var">GameState</span></a><span> </span><a name="local-6989586621679085551"><a href="#local-6989586621679085551"><span class="hs-identifier">player</span></a></a><span> </span><a name="local-6989586621679085552"><a href="#local-6989586621679085552"><span class="hs-identifier">level</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-26"></a><span>  </span><a href="Herraria.Render.html#scaleViewPort"><span class="hs-identifier hs-var">scaleViewPort</span></a><span> </span><a href="#local-6989586621679085554"><span class="hs-identifier hs-var">viewportScale</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Herraria.Render.html#focusOnPlayer"><span class="hs-identifier hs-var">focusOnPlayer</span></a><span> </span><a href="#local-6989586621679085551"><span class="hs-identifier hs-var">player</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-27"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679085553"><span class="hs-identifier hs-var">otherstuff</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Herraria.Player.html#drawPlayer"><span class="hs-identifier hs-var">drawPlayer</span></a><span> </span><a href="#local-6989586621679085551"><span class="hs-identifier hs-var">player</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Herraria.Render.html#drawGrid"><span class="hs-identifier hs-var">drawGrid</span></a><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-29"></a><span>    </span><a name="local-6989586621679085553"><a href="#local-6989586621679085553"><span class="hs-identifier">otherstuff</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Herraria.Render.html#drawLevel"><span class="hs-identifier hs-var">drawLevel</span></a><span> </span><a href="#local-6989586621679085552"><span class="hs-identifier hs-var">level</span></a><span>
</span><a name="line-30"></a><span>    </span><a name="local-6989586621679085554"><a href="#local-6989586621679085554"><span class="hs-identifier">viewportScale</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-comment">-- | Draw base grid</span><span>
</span><a name="line-33"></a><span class="hs-identifier">drawGrid</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Picture</span><span>
</span><a name="line-34"></a><a name="drawGrid"><a href="Herraria.Render.html#drawGrid"><span class="hs-identifier">drawGrid</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">translate</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-keyword">unit</span><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-keyword">unit</span><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679085555"><span class="hs-identifier hs-var">horizontal</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679085556"><span class="hs-identifier hs-var">vertical</span></a><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-36"></a><span>    </span><a name="local-6989586621679085555"><a href="#local-6989586621679085555"><span class="hs-identifier">horizontal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pictures</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">line</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-keyword">unit</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679085558"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-keyword">unit</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679085557"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679085558"><a href="#local-6989586621679085558"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="Herraria.Level.html#chunkWidth"><span class="hs-identifier hs-var">chunkWidth</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679085557"><a href="#local-6989586621679085557"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="Herraria.Level.html#chunkHeight"><span class="hs-identifier hs-var">chunkHeight</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-37"></a><span>    </span><a name="local-6989586621679085556"><a href="#local-6989586621679085556"><span class="hs-identifier">vertical</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pictures</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">line</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-keyword">unit</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679085559"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-keyword">unit</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679085560"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679085560"><a href="#local-6989586621679085560"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="Herraria.Level.html#chunkHeight"><span class="hs-identifier hs-var">chunkHeight</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679085559"><a href="#local-6989586621679085559"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="Herraria.Level.html#chunkWidth"><span class="hs-identifier hs-var">chunkWidth</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-comment">-- | Base block picture</span><span>
</span><a name="line-40"></a><span class="hs-identifier">unitBlockPic</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Picture</span><span>
</span><a name="line-41"></a><a name="unitBlockPic"><a href="Herraria.Render.html#unitBlockPic"><span class="hs-identifier">unitBlockPic</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">rectangleSolid</span><span> </span><span class="hs-keyword">unit</span><span> </span><span class="hs-keyword">unit</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-comment">-- | Draw block</span><span>
</span><a name="line-44"></a><span class="hs-identifier">drawBlock</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Herraria.Level.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Picture</span><span>
</span><a name="line-45"></a><a name="drawBlock"><a href="Herraria.Render.html#drawBlock"><span class="hs-identifier">drawBlock</span></a></a><span> </span><a href="Herraria.Level.html#Air"><span class="hs-identifier hs-var">Air</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">color</span><span> </span><a href="Herraria.Render.html#airBlue"><span class="hs-identifier hs-var">airBlue</span></a><span> </span><a href="Herraria.Render.html#unitBlockPic"><span class="hs-identifier hs-var">unitBlockPic</span></a><span>
</span><a name="line-46"></a><span class="hs-identifier">drawBlock</span><span> </span><a href="Herraria.Level.html#Ground"><span class="hs-identifier hs-var">Ground</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">color</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dark</span><span> </span><span class="hs-identifier hs-var">orange</span><span class="hs-special">)</span><span> </span><a href="Herraria.Render.html#unitBlockPic"><span class="hs-identifier hs-var">unitBlockPic</span></a><span>
</span><a name="line-47"></a><span class="hs-identifier">drawBlock</span><span> </span><a href="Herraria.Level.html#Bedrock"><span class="hs-identifier hs-var">Bedrock</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">color</span><span> </span><span class="hs-identifier hs-var">black</span><span> </span><a href="Herraria.Render.html#unitBlockPic"><span class="hs-identifier hs-var">unitBlockPic</span></a><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-comment">-- | Draw block with some shift</span><span>
</span><a name="line-50"></a><span class="hs-identifier">drawBlockAt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Herraria.Level.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Picture</span><span>
</span><a name="line-51"></a><a name="drawBlockAt"><a href="Herraria.Render.html#drawBlockAt"><span class="hs-identifier">drawBlockAt</span></a></a><span> </span><a name="local-6989586621679085561"><a href="#local-6989586621679085561"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679085562"><a href="#local-6989586621679085562"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-52"></a><span>  </span><span class="hs-identifier hs-var">translate</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">unit</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679085561"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">unit</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679085562"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Herraria.Render.html#drawBlock"><span class="hs-identifier hs-var">drawBlock</span></a><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-comment">-- | Draw chunk with ofset to zero chunk</span><span>
</span><a name="line-55"></a><span class="hs-identifier">drawChunkAt</span><span>
</span><a name="line-56"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ Ofset from zero chunk</span><span>
</span><a name="line-57"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Herraria.Level.html#Chunk"><span class="hs-identifier hs-type">Chunk</span></a><span> </span><a href="Herraria.Level.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><span class="hs-comment">-- ^ Chunk</span><span>
</span><a name="line-58"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Picture</span><span> </span><span class="hs-comment">-- ^ Result picture</span><span>
</span><a name="line-59"></a><a name="drawChunkAt"><a href="Herraria.Render.html#drawChunkAt"><span class="hs-identifier">drawChunkAt</span></a></a><span> </span><a name="local-6989586621679085563"><a href="#local-6989586621679085563"><span class="hs-identifier">delta</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-60"></a><span>  </span><span class="hs-identifier hs-var">translate</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">unit</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><a href="Herraria.Level.html#chunkWidth"><span class="hs-identifier hs-var">chunkWidth</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679085563"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Herraria.Render.html#drawChunk"><span class="hs-identifier hs-var">drawChunk</span></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">-- | Draw chunk</span><span>
</span><a name="line-63"></a><span class="hs-identifier">drawChunk</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Herraria.Level.html#Chunk"><span class="hs-identifier hs-type">Chunk</span></a><span> </span><a href="Herraria.Level.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Picture</span><span>
</span><a name="line-64"></a><a name="drawChunk"><a href="Herraria.Render.html#drawChunk"><span class="hs-identifier">drawChunk</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mconcat</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Herraria.Level.html#chunkToLists"><span class="hs-identifier hs-var">chunkToLists</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Herraria.Level.html#imapChunk"><span class="hs-identifier hs-var">imapChunk</span></a><span> </span><a href="Herraria.Render.html#drawBlockAt"><span class="hs-identifier hs-var">drawBlockAt</span></a><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-comment">-- | How many chunks will draw at time</span><span>
</span><a name="line-67"></a><span class="hs-identifier">loadedChunksAmount</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-68"></a><a name="loadedChunksAmount"><a href="Herraria.Render.html#loadedChunksAmount"><span class="hs-identifier">loadedChunksAmount</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">-- | Draw level</span><span>
</span><a name="line-71"></a><span class="hs-identifier">drawLevel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Herraria.Level.html#Level"><span class="hs-identifier hs-type">Level</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Picture</span><span>
</span><a name="line-72"></a><a name="drawLevel"><a href="Herraria.Render.html#drawLevel"><span class="hs-identifier">drawLevel</span></a></a><span> </span><span class="hs-special">(</span><a href="Herraria.Level.html#Level"><span class="hs-identifier hs-var">Level</span></a><span> </span><a name="local-6989586621679085564"><a href="#local-6989586621679085564"><span class="hs-identifier">ls</span></a></a><span> </span><a name="local-6989586621679085565"><a href="#local-6989586621679085565"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679085566"><a href="#local-6989586621679085566"><span class="hs-identifier">rs</span></a></a><span> </span><a name="local-6989586621679085567"><a href="#local-6989586621679085567"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">translate</span><span> </span><a href="#local-6989586621679085571"><span class="hs-identifier hs-var">ofset</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679085569"><span class="hs-identifier hs-var">leftChunks'</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Herraria.Render.html#drawChunk"><span class="hs-identifier hs-var">drawChunk</span></a><span> </span><a href="#local-6989586621679085565"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679085570"><span class="hs-identifier hs-var">rightChunks'</span></a><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-74"></a><span>    </span><a name="local-6989586621679085568"><a href="#local-6989586621679085568"><span class="hs-identifier">amount</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Herraria.Render.html#loadedChunksAmount"><span class="hs-identifier hs-var">loadedChunksAmount</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-75"></a><span>    </span><a name="local-6989586621679085569"><a href="#local-6989586621679085569"><span class="hs-identifier">leftChunks'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mconcat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zipWith</span><span> </span><a href="Herraria.Render.html#drawChunkAt"><span class="hs-identifier hs-var">drawChunkAt</span></a><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><a href="#local-6989586621679085568"><span class="hs-identifier hs-var">amount</span></a><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">take</span><span> </span><a href="#local-6989586621679085568"><span class="hs-identifier hs-var">amount</span></a><span> </span><a href="#local-6989586621679085564"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>    </span><a name="local-6989586621679085570"><a href="#local-6989586621679085570"><span class="hs-identifier">rightChunks'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mconcat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zipWith</span><span> </span><a href="Herraria.Render.html#drawChunkAt"><span class="hs-identifier hs-var">drawChunkAt</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">..</span><span> </span><a href="#local-6989586621679085568"><span class="hs-identifier hs-var">amount</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">take</span><span> </span><a href="#local-6989586621679085568"><span class="hs-identifier hs-var">amount</span></a><span> </span><a href="#local-6989586621679085566"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span>    </span><a name="local-6989586621679085571"><a href="#local-6989586621679085571"><span class="hs-identifier">ofset</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679085567"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="Herraria.Level.html#chunkWidth"><span class="hs-identifier hs-var">chunkWidth</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-keyword">unit</span><span>
</span><a name="line-78"></a></pre></body></html>